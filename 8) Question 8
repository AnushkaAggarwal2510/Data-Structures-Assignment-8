Question 8) Write a program to merge two BSTs into a doubly-linked list in sorted order.

Answer 8)

#include <stdio.h>
#include <stdlib.h>

struct Node {
    int data;
    struct Node* left;
    struct Node* right;
};

struct Node* createNode(int data) {
    struct Node* n = (struct Node*)malloc(sizeof(struct Node));
    n->data = data;
    n->left = n->right = NULL;
    return n;
}

struct Node* insert(struct Node* root, int data) {
    if (root == NULL)
        return createNode(data);

    if (data < root->data)
        root->left = insert(root->left, data);
    else if (data > root->data)
        root->right = insert(root->right, data);

    return root;
}
void bstToDLL(struct Node* root, struct Node** head, struct Node** prev) {
    if (root == NULL) return;

    bstToDLL(root->left, head, prev);

    if (*prev == NULL) {
        *head = root;
    } else {
        root->left = *prev;
        (*prev)->right = root;
    }

    *prev = root;
    bstToDLL(root->right, head, prev);
}
struct Node* mergeDLL(struct Node* h1, struct Node* h2) {
    if (h1 == NULL) return h2;
    if (h2 == NULL) return h1;

    struct Node* head = NULL;
    struct Node* tail = NULL;

    while (h1 != NULL && h2 != NULL) {
        struct Node* temp;

        if (h1->data < h2->data) {
            temp = h1;
            h1 = h1->right;
        } else {
            temp = h2;
            h2 = h2->right;
        }

        if (head == NULL) {
            head = tail = temp;
            head->left = NULL;
        } else {
            tail->right = temp;
            temp->left = tail;
            tail = temp;
        }
    }
    if (h1 != NULL) {
        tail->right = h1;
        h1->left = tail;
    }
    if (h2 != NULL) {
        tail->right = h2;
        h2->left = tail;
    }

    return head;
}
void printDLL(struct Node* head) {
    printf("Sorted Doubly Linked List: ");
    while (head != NULL) {
        printf("%d ", head->data);
        head = head->right;
    }
    printf("\n");
}

int main() {
    struct Node *root1 = NULL, *root2 = NULL;
    int n1, n2, val;

    printf("Enter number of nodes in BST 1: ");
    scanf("%d", &n1);

    printf("Enter %d values:\n", n1);
    for (int i = 0; i < n1; i++) {
        scanf("%d", &val);
        root1 = insert(root1, val);
    }

    printf("\nEnter number of nodes in BST 2: ");
    scanf("%d", &n2);

    printf("Enter %d values:\n", n2);
    for (int i = 0; i < n2; i++) {
        scanf("%d", &val);
        root2 = insert(root2, val);
    }
    struct Node *head1 = NULL, *prev1 = NULL;
    bstToDLL(root1, &head1, &prev1);

    struct Node *head2 = NULL, *prev2 = NULL;
    bstToDLL(root2, &head2, &prev2);

    struct Node* mergedHead = mergeDLL(head1, head2);

    printDLL(mergedHead);

    return 0;
}
